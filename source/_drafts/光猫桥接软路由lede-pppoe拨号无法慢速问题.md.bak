---
title: 光猫桥接软路由lede pppoe拨号无法慢速问题
date: 2020-04-09 19:27:22
tags: [软路由, lede, 网络]
category: 黑科技
---

购买了一台蜗牛星际B款双网口，装了黑群晖加软路由lede。再上一遍教程中，写了将光猫设置为桥接的方法。一切就绪就等着使用软路由拨号上网了。 

## 软路由拨号不如光猫是什么问题

软路由刚开始设置的时候，拨号一直连不上，总是错误不断，然后就关闭ipv6， 开启ipv6，把某些特殊的设置屏蔽掉，我用的是lede 软路由系统，我第一次拨号，他会显示User Request 错误，不过不用管它，过几十秒他就自己变好了。但是速度巨慢，我家是 200M 的网络，使用光猫拨号随便跑到200多，但是使用软路由拨号成功后去测试，只有 四五十兆左右。 当时做了以下猜测：

* 蜗牛星际性能不行

    通过实验进行对比，可以判断不是蜗牛星际的问题。首先光猫拨号，然后连接软路由(蜗牛星际中虚拟机设置的wan端口)，然后蜗牛软路由lan口(蜗牛星际虚拟机中设置为lan的端口)连接千兆路由器，然后电脑通过wifi连接千兆路由器，测试发现网速可以跑到两百多兆，这说明流量在通过这一连串的设备时，并没有因为哪个设备的性能不行导致网速下降的。所以应该不是蜗牛星际的问题。

* 运营商绑定了mac地址，或者对陌生设备拨号做了限制

    想要证明这点，我直接把端口不连软路由，直接连接千兆路由器，让千兆路由器进行拨号，拨号的结果和光猫拨号速度差不多，所以说应该也不是运营商的问题。期间我还试过把路由器拨号的mac地址改为软路由的地址，发现网速照样很快，那就说明并不是运营商进行了限制，问题出在了软路由这里。
<!--more -->
<!--more -->

通过以上分析，大概可以判断问题出现在哪里了， 第一：问题应该不是出在软路由的硬件上，我这里只是粗略的估计，毕竟直连光猫通过软路由速度也能跑到两百多兆。很有可能问题出现在了lede这个系统上面，版本bug或者当时的一些误操作把本来要优化的东西搞成了负优化。期间尝试了各种方法来调试，都无法达到正常的速度，最高也只有七八十兆，并且测试网站还有点显示不正常，怀疑是否发生了丢包。无奈之下，本着不搞定不罢休的状态，麻烦也得搞。 

进行暴力尝试： 更换软路由固件，刷了一个 ikuai ，想着换个软路由固件来确定是lede pppoe拨号的问题。 在群晖的 vmm 中安装好 ikuai之后，进行了拨号，非常轻松，没有任何错误，一连就上，并且测速也达到了预期的效果。 再次确认不是硬件的问题，而就是lede 的问题。

但是难受的就是，当我开始寻找插件的时候，却发现 ikuai 其实是不支持 lede 那么多插件的。 这样的话，我还不如直接光猫拨号呢。 于是乎，卸载 ikuai，就行最后一次尝试，重装 lede， 并且更换了一个版本，首先别的什么都先不搞，先设置拨号，拨号完一测， 达到了预期的效果，接着开始修改配置，装插件，每走一步测一遍，最终走完了所有的设置及安装了插件，发现网速始终正常，完成。

总结： lede 遇到问题后，可以考虑重新安装lede，或者更换 lede 版本进行尝试。



2020-4-9 23:00 更新： 

   由于vmm里面网诚设置成了 e100 ,这样可以在 lede 页面显示 全双工，否则显示的是 半双工，好像是半双工也没有什么影响，设置回virtual 再拨号就没问题了。

